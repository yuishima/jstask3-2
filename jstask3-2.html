<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js制作課題③－4</title>
</head>
<body>
    <h1>ToDoリスト</h1>
    <div id="todo-list">
        <input type="radio" name="select-item" id="all-select" checked>全て
        <input type="radio" name="select-item" id="doing-select">作業中
        <input type="radio" name="select-item" id="done-select">完了
        <h2>新規タスクの追加</h2>
        <input type="text" id="add-todo">
        <input type="button" id="add-btn" value="追加">
    </div>
    <table>
        <thead>
            <th>ID</th>
            <th> コメント </th>
            <th> 状態 </th>
            <th></th>
        </thead>
        <tbody  id="display">
        </tbody>
    </table>
    <script>
        'use strict';
        //配列定義
        const todoList = [];
        const btn = document.getElementById('add-btn');
        const todoListElement = document.getElementById('display');
        btn.addEventListener('click', () => {
            displayList();
        });
        //空の配列に入力値を入れていくfunction
        const displayList = () => {
            const todo = document.getElementById("add-todo").value;
            document.getElementById("add-todo").value = "";
            const tasks = todoList.task;
            if(todo){
                todoList.push({id: todoList.length, task: todo, status: '作業中'});
                displayResult(todoList);
            }
        };
        //表示function
        const displayResult = (filterdTodoList) => {
            while(todoListElement.firstChild){
                todoListElement.removeChild(todoListElement.firstChild);
            };
            filterdTodoList.forEach((todo, index) => {
                const trList = document.createElement('tr');
                //index番号の要素追加
                const tdIndex = document.createElement('td');
                tdIndex.textContent = todo.id;
                //コメントの要素追加
                const tdValue = document.createElement('td');
                tdValue.textContent = todo.task;
                //作業中、削除ボタンの要素追加
                const checkButton = createCheckButton(todo);
                const removeButton = createRemoveButton(todo.id);
                //表示
                trList.appendChild(tdIndex);
                trList.appendChild(tdValue);
                trList.appendChild(checkButton);
                trList.appendChild(removeButton);
                todoListElement.appendChild(trList);
            });
        };
        //作業中ボタンの生成function
        const createCheckButton = (todo) => {
            const tdBtn = document.createElement('td');
            const checkBtn = document.createElement('input');
            checkBtn.setAttribute('type', 'button');
            checkBtn.setAttribute('value', todo.status);
            checkBtn.addEventListener('click', () => {
                checkTodo(todo);
            });
            return checkBtn;
        };
        //削除ボタンの生成function
        const createRemoveButton = (index) => {
            const tdBtn = document.createElement('td');
            const removeBtn = document.createElement('input');
            removeBtn.setAttribute('type', 'button');
            removeBtn.setAttribute('value', '削除');
            removeBtn.addEventListener('click', () => {
                removeTodo(index);
            });
            return removeBtn;
        };
        //作業中を押す
        const checkTodo = (todo) =>{
            if(todo.status === "作業中"){
            todo.status = "完了";
            }else{
            todo.status = "作業中";
            };
            console.log(todo.status);
            displayResult(todoList);
        };
        //削除を押す
        const removeTodo = (index) =>{
            todoList.splice(index,1);
            displayResult(todoList);
        };
        //全体リストアップ
        const allRadio = document.getElementById('all-select');
        allRadio.addEventListener('click', () =>{
            const filterdTodoList = todoList;
            displayResult(filterdTodoList);
        });
        //作業中リストアップ
        const doingRadio = document.getElementById('doing-select');
        doingRadio.addEventListener('click', () =>{
            const filterdTodoList = todoList.filter(todo => todo.status === "作業中");
            displayResult(filterdTodoList);
        });
　　　　//完了リストアップ
        const doneRadio = document.getElementById('done-select');
        doneRadio.addEventListener('click', () =>{
            const filterdTodoList = todoList.filter(todo => todo.status === "完了");
            displayResult(filterdTodoList);
        });
    </script>
</body>
</html>